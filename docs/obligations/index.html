<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>Obligations - policy-machine-core</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"><link rel="stylesheet" href="../css/extra.css"></head><body dir="ltr"><svg class="md-svg"><defs></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#obligations" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href=".." title="policy-machine-core" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">policy-machine-core</span><span class="md-header-nav__topic">Obligations</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href=".." title="policy-machine-core" class="md-nav__button md-logo"><i class="md-icon"></i></a>policy-machine-core</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item"><a href="../installation/" title="Installation" class="md-nav__link">Installation</a></li><li class="md-nav__item"><a href="../getting-started/" title="Getting Started" class="md-nav__link">Getting Started</a></li><li class="md-nav__item"><a href="../functional-components/" title="Functional Components" class="md-nav__link">Functional Components</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Obligations</label><a href="./" title="Obligations" class="md-nav__link md-nav__link--active">Obligations</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#common-elements" title="Common Elements" class="md-nav__link">Common Elements</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#nodes" title="Nodes" class="md-nav__link">Nodes</a></li><li class="md-nav__item"><a href="#function" title="function" class="md-nav__link">function</a></li></ul></nav></li><li class="md-nav__item"><a href="#obligation" title="Obligation" class="md-nav__link">Obligation</a></li><li class="md-nav__item"><a href="#rule" title="Rule" class="md-nav__link">Rule</a></li><li class="md-nav__item"><a href="#event-pattern" title="Event Pattern" class="md-nav__link">Event Pattern</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#subject" title="Subject" class="md-nav__link">Subject</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#user" title="user" class="md-nav__link">user</a></li><li class="md-nav__item"><a href="#any_user" title="any_user" class="md-nav__link">any_user</a></li><li class="md-nav__item"><a href="#process" title="process" class="md-nav__link">process</a></li></ul></nav></li><li class="md-nav__item"><a href="#policy-class" title="Policy Class" class="md-nav__link">Policy Class</a></li><li class="md-nav__item"><a href="#operations" title="Operations" class="md-nav__link">Operations</a></li><li class="md-nav__item"><a href="#target" title="Target" class="md-nav__link">Target</a></li></ul></nav></li><li class="md-nav__item"><a href="#response" title="Response" class="md-nav__link">Response</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#condition" title="Condition" class="md-nav__link">Condition</a></li><li class="md-nav__item"><a href="#create-action" title="Create Action" class="md-nav__link">Create Action</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#rule_1" title="rule" class="md-nav__link">rule</a></li><li class="md-nav__item"><a href="#nodes_1" title="nodes" class="md-nav__link">nodes</a></li></ul></nav></li><li class="md-nav__item"><a href="#assign-action" title="Assign Action" class="md-nav__link">Assign Action</a></li><li class="md-nav__item"><a href="#grant-action" title="Grant Action" class="md-nav__link">Grant Action</a></li><li class="md-nav__item"><a href="#deny-action" title="Deny Action" class="md-nav__link">Deny Action</a></li><li class="md-nav__item"><a href="#delete-action" title="Delete Action" class="md-nav__link">Delete Action</a></li></ul></nav></li><li class="md-nav__item"><a href="#functions" title="Functions" class="md-nav__link">Functions</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#predefined-functions" title="Predefined Functions" class="md-nav__link">Predefined Functions</a></li><li class="md-nav__item"><a href="#how-to-add-a-function" title="How to add a function" class="md-nav__link">How to add a function</a></li></ul></nav></li><li class="md-nav__item"><a href="#how-to-extend-the-event-pattern" title="How to Extend the Event Pattern" class="md-nav__link">How to Extend the Event Pattern</a></li></ul></nav></li><li class="md-nav__item"><a href="../examples/" title="Examples" class="md-nav__link">Examples</a></li><li class="md-nav__item"><a href="../contact/" title="Contact Us" class="md-nav__link">Contact Us</a></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#common-elements" title="Common Elements" class="md-nav__link">Common Elements</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#nodes" title="Nodes" class="md-nav__link">Nodes</a></li><li class="md-nav__item"><a href="#function" title="function" class="md-nav__link">function</a></li></ul></nav></li><li class="md-nav__item"><a href="#obligation" title="Obligation" class="md-nav__link">Obligation</a></li><li class="md-nav__item"><a href="#rule" title="Rule" class="md-nav__link">Rule</a></li><li class="md-nav__item"><a href="#event-pattern" title="Event Pattern" class="md-nav__link">Event Pattern</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#subject" title="Subject" class="md-nav__link">Subject</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#user" title="user" class="md-nav__link">user</a></li><li class="md-nav__item"><a href="#any_user" title="any_user" class="md-nav__link">any_user</a></li><li class="md-nav__item"><a href="#process" title="process" class="md-nav__link">process</a></li></ul></nav></li><li class="md-nav__item"><a href="#policy-class" title="Policy Class" class="md-nav__link">Policy Class</a></li><li class="md-nav__item"><a href="#operations" title="Operations" class="md-nav__link">Operations</a></li><li class="md-nav__item"><a href="#target" title="Target" class="md-nav__link">Target</a></li></ul></nav></li><li class="md-nav__item"><a href="#response" title="Response" class="md-nav__link">Response</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#condition" title="Condition" class="md-nav__link">Condition</a></li><li class="md-nav__item"><a href="#create-action" title="Create Action" class="md-nav__link">Create Action</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#rule_1" title="rule" class="md-nav__link">rule</a></li><li class="md-nav__item"><a href="#nodes_1" title="nodes" class="md-nav__link">nodes</a></li></ul></nav></li><li class="md-nav__item"><a href="#assign-action" title="Assign Action" class="md-nav__link">Assign Action</a></li><li class="md-nav__item"><a href="#grant-action" title="Grant Action" class="md-nav__link">Grant Action</a></li><li class="md-nav__item"><a href="#deny-action" title="Deny Action" class="md-nav__link">Deny Action</a></li><li class="md-nav__item"><a href="#delete-action" title="Delete Action" class="md-nav__link">Delete Action</a></li></ul></nav></li><li class="md-nav__item"><a href="#functions" title="Functions" class="md-nav__link">Functions</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#predefined-functions" title="Predefined Functions" class="md-nav__link">Predefined Functions</a></li><li class="md-nav__item"><a href="#how-to-add-a-function" title="How to add a function" class="md-nav__link">How to add a function</a></li></ul></nav></li><li class="md-nav__item"><a href="#how-to-extend-the-event-pattern" title="How to Extend the Event Pattern" class="md-nav__link">How to Extend the Event Pattern</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="obligations">Obligations</h1>
<p>Obligations are defined using a yaml syntax described below.</p>
<h2 id="common-elements">Common Elements</h2>
<h3 id="nodes">Nodes</h3>
<p>A node represents a node in an NGAC graph. A node has a name, type, and properties. A node can also be derived from a function.</p>
<pre><code class="yaml">name:
type:
properties:
  - key: value
</code></pre>

<h3 id="function">function</h3>
<p>A function refers to a previously defined function that is supported by the Policy Machine Event Processing Point (EPP).  A list of valid functions, as well as tutorial on how to add functions can be found <a href="#functions">here</a>.</p>
<p><em>Example</em></p>
<pre><code class="yaml">function:
  name:
  args:
    - &quot;&quot;
    - function:
</code></pre>

<p>A function has a name and a list of arguments. The arguments are a list of string values or other functions.</p>
<h2 id="obligation">Obligation</h2>
<p>There is one obligation per yaml file. An obligation can have zero or more rules.</p>
<pre><code class="yaml">label:
rules:
</code></pre>

<ul>
<li><strong><em>label</em></strong> - A label to give the obligation.  If one is not specified, then a random value will be used.</li>
<li><strong><em>rules</em></strong> - Contains a set of zero or more rules.</li>
</ul>
<h2 id="rule">Rule</h2>
<pre><code class="yaml">label:
event:
response:
</code></pre>

<ul>
<li><strong><em>label</em></strong> - A label to give the rule.  If one is not specified a random value will be used.</li>
<li><strong><em>event</em></strong> - The event pattern for this rule.</li>
<li><strong><em>response</em></strong> - The response to the event.</li>
</ul>
<h2 id="event-pattern">Event Pattern</h2>
<pre><code class="yaml">event:
  subject:
  policyClass:
  operations:
  target:
</code></pre>

<p>The Event Pattern specifies an event involving the policy elements of the Policy Machine.  An example is a user performing a read operation on an object.  This is called an access event, which is the primary focus of obligations as described in the NGAC standard. An access event has four components: The subject, policy class, operations, and target.  All of these are optional, but omitting them will have different consequences, which will be described in the sections below.</p>
<p>While the Policy Machine focuses on access events, it is possible to extend the functionality of the Event Pattern to other events such as time.  The section <a href="#how-to-extend-the-event-pattern">How to Extend the Event Pattern</a> section provides a tutorial on how this is possible with the Policy Machine.</p>
<h3 id="subject">Subject</h3>
<pre><code class="yaml">subject:
  user:
  any_user:
  process:
</code></pre>

<p>The subject specification can be a user, any user, any user from a set of users and/or user attributes, or a process.  If the subject is omitted than all events will match this component of an access event.</p>
<h4 id="user">user</h4>
<p>A user is identified by it's name.</p>
<h4 id="any_user">any_user</h4>
<pre><code class="yaml">any_user:
</code></pre>

<p>The <code>any_user</code> element accepts an array of strings representing user names.  If the element is empty then any user will match.</p>
<h4 id="process">process</h4>
<pre><code class="yaml">process:
</code></pre>

<p>The <code>process</code> element accepts a number as a process ID.</p>
<p><em>Example:</em></p>
<pre><code class="yaml">any_user: # any user
###
any_user: # u1 or u2
  - &quot;u1&quot;
  - &quot;u2&quot;
process: 12345
</code></pre>

<h3 id="policy-class">Policy Class</h3>
<pre><code class="yaml">policy_class:
  anyOf:
  ---
  eachOf:
</code></pre>

<p>The policy class specification can specify a particular policy class with a given name, any policy class, any policy class from a set, all policy classes from a set, or all policy classes. Only one of <code>anyOf</code> and <code>eachOf</code> are allowed.</p>
<p><em>Example</em></p>
<pre><code class="yaml">###
policyClass: # a;; policy class
###
policyClass: # PC1 or PC2
  anyOf:
    - &quot;PC1&quot;
    - &quot;PC2&quot;
###
policyClass: # PC1 and PC2
  eachOf:
    - &quot;PC1&quot;
    - &quot;PC2&quot;
</code></pre>

<h3 id="operations">Operations</h3>
<pre><code class="yaml">operations:
  - &quot;operation_name&quot;
</code></pre>

<p>The operations specification is a string array of operation names. Any event that matches an element of the array will match the operations event pattern.</p>
<p><em>Example:</em></p>
<pre><code class="yaml">operations:
  - &quot;read&quot;
  - &quot;write&quot;
</code></pre>

<h3 id="target">Target</h3>
<p>The target of an event can be</p>
<ul>
<li>A specific policy element</li>
</ul>
<pre><code class="yaml">policyElements:
  - name: name
    type: type
</code></pre>

<ul>
<li>Any policy element</li>
</ul>
<pre><code class="yaml">policyElements:
</code></pre>

<p>* Omitting <code>policyElements</code> will have the same effect</p>
<ul>
<li>Any policy element that is contained in other policy elements</li>
</ul>
<pre><code class="yaml">containers:
  - name:
    type:
  - name:
    type:
</code></pre>

<ul>
<li>Any policy element from a set of policy elements</li>
</ul>
<pre><code class="yaml">policyElements:
  - name: name
    type: type
  - name: name
    type: type
</code></pre>

<ul>
<li>If both <code>policyElements</code> and <code>containers</code> are omitted it will be "any policyElement in any container"</li>
<li>If <code>containers</code> is present then it will be "any policyElement in the containers", regardless of if policyElements is present</li>
<li>If <code>policyElements</code> is present its "any policyElement from the list provided"</li>
</ul>
<h2 id="response">Response</h2>
<p>A response is a series of conditional actions. A condition can also be applied to the response itself.</p>
<h3 id="condition">Condition</h3>
<p>A condition is a set of boolean expressions that if all evaluate to true, allow for a response or specific action to be executed.</p>
<pre><code class="yaml">condition:
  - function:
  - function:
</code></pre>

<h3 id="create-action">Create Action</h3>
<p>Create
1. A rule
2. A set of nodes and assign them to a set of containers</p>
<h4 id="rule_1">rule</h4>
<pre><code class="yaml">create:
  rule:
    label:
    event:
    response:
</code></pre>

<h4 id="nodes_1">nodes</h4>
<p>Creating nodes requires the name and type of the nodes to create and the containers in which to assign them. A node can be specified with a set of properties if applicable.</p>
<pre><code class="yaml">create:
  what:
    - name: node1
      type: UA
  where:
    - name: container1
      type: UA
</code></pre>

<h3 id="assign-action">Assign Action</h3>
<pre><code class="yaml">assign:
  what:
  where:
</code></pre>

<p>The <code>what</code> and <code>where</code> elements are arrays of nodes.  The nodes in <code>what</code> will be assigned to the nodes in <code>where</code>.</p>
<h3 id="grant-action">Grant Action</h3>
<p>Associate each node in <code>subjects</code> with each node in <code>targets</code>.</p>
<pre><code class="yaml">grant:
  subjects:
  operations:
  targets:
</code></pre>

<ul>
<li><code>subjects</code> is an array of nodes that will be the subject of the associations created.</li>
<li><code>operations</code> is an array of operations to add to the associations.</li>
<li><code>targets</code> is an array of nodes that will be the targets of the associations.</li>
</ul>
<h3 id="deny-action">Deny Action</h3>
<p>Deny a subject a set of operations on a set of target attributes. The subject can be a function, a process, or a node.
The operations are an array of string.  The target of the deny can be the intersection of a set of containers. It can also be the complement of the logical evaluation of the containers. Each container is identified by a name and type (properties are optional).  If more than one node matches the provided name and type all will be taken into account. It is possible to take the complement of an individual container using the <code>complement</code> element.</p>
<pre><code class="yaml">deny:
  subject: priority goes 1. function, 2. process, 3. node
   function:
   ---
   process:
   ---
   name:
   type:
   properties:
 operations:
   - &quot;&quot;
   - &quot;&quot;
 target:
   complement: true|false, default false
   intersection: true|false, default false
   containers:
     - name:
       type:
       complement: true|false, default false
     - function:
       complement: true|false
</code></pre>

<h3 id="delete-action">Delete Action</h3>
<p>Delete</p>
<ul>
<li>assignment relations</li>
<li>deny relations</li>
<li>grant relations</li>
<li>created policy elements</li>
<li>created rules</li>
</ul>
<p><code>yaml
delete:
  create:
  assign:
  grant:
  deny:</code> s</p>
<h2 id="functions">Functions</h2>
<h3 id="predefined-functions">Predefined Functions</h3>
<ol>
<li>current_user</li>
<li>current_process</li>
</ol>
<h3 id="how-to-add-a-function">How to add a function</h3>
<h2 id="how-to-extend-the-event-pattern">How to Extend the Event Pattern</h2></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../functional-components/" title="Functional Components" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Functional Components</span></div></a><a href="../examples/" title="Examples" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>Examples</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script></body></html>